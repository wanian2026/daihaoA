# 测试工具使用指南

## 概述

项目提供了两个测试脚本，用于验证系统功能和交易所连接。

## 测试脚本

### 1. test_connection.py - 基础功能测试

**功能：**
- 测试所有Python模块是否正常导入
- 测试配置文件加载功能
- 测试交易所实例创建
- 无需真实API Key即可运行

**使用方法：**
```bash
python3 test_connection.py
```

**适用场景：**
- 首次使用，验证系统安装
- 修改代码后，验证基础功能
- 检查配置文件格式是否正确

**预期输出：**
```
==================================================
模块功能测试（无需API）
==================================================

📋 测试配置管理...
✅ 配置加载成功
   交易所: binance
   交易对: BTC/USDT

🔧 测试交易所实例创建...
✅ 交易所实例创建成功
   测试网络模式: True
   API Key: test_key...

==================================================
基本功能测试完成
==================================================
```

### 2. test_balance.py - 完整连接测试

**功能：**
- 连接币安交易所（使用真实API）
- 测试连接是否成功
- 获取账户余额
- 获取市场行情数据

**使用方法：**
```bash
python3 test_balance.py
```

**前置条件：**
1. 已完成配置（运行过 `python3 src/main.py`）
2. 在 `config/config.json` 中配置了有效的API Key和Secret
3. 建议先使用测试网络

**适用场景：**
- 验证API Key和Secret是否正确
- 查看账户余额
- 验证交易所连接
- 启动策略前的连接测试

**预期输出：**
```
==================================================
币安连接和余额测试
==================================================

📡 正在连接币安交易所...
🔍 测试连接...
✅ 连接成功！

💰 获取账户余额...

--------------------------------------------------
账户余额:
--------------------------------------------------
  USDT:
    总计: 1000.00000000
    可用: 1000.00000000
    冻结: 0.00000000
  BTC:
    总计: 0.50000000
    可用: 0.50000000
    冻结: 0.00000000
--------------------------------------------------
USDT 价值估算: ~1000.00 USDT
--------------------------------------------------

📊 获取市场行情...
  BTC/USDT:
    最新价格: 45000.00
    24h最高: 46000.00
    24h最低: 44000.00
    24h涨跌: +2.50%

✅ 测试完成！

提示: 如果余额正常，可以运行策略:
   python3 src/main.py
```

## 使用流程

### 首次使用流程

1. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **基础测试**
   ```bash
   python3 test_connection.py
   ```
   确认所有模块正常

3. **配置系统**
   ```bash
   python3 src/main.py
   ```
   输入API Key和配置参数

4. **连接测试**
   ```bash
   python3 test_balance.py
   ```
   验证API连接和账户余额

5. **启动策略**
   ```bash
   python3 src/main.py
   ```
   确认启动

### 常规使用流程

每次启动策略前，建议运行连接测试：
```bash
# 1. 测试连接和余额
python3 test_balance.py

# 2. 确认正常后启动策略
python3 src/main.py
```

## 故障排查

### 问题1：test_connection.py 失败

**可能原因：**
- Python依赖未安装
- 代码文件损坏

**解决方法：**
```bash
pip install -r requirements.txt
```

### 问题2：test_balance.py 提示API未配置

**可能原因：**
- 配置文件中的API Key或Secret为空

**解决方法：**
```bash
# 重新运行配置向导
python3 src/main.py
```

### 问题3：test_balance.py 连接失败

**可能原因：**
- API Key或Secret错误
- 网络问题
- API权限不足

**解决方法：**
1. 检查API Key和Secret是否正确
2. 检查网络连接
3. 确认API权限包含"现货交易"
4. 检查IP白名单设置

### 问题4：余额显示为0

**可能原因：**
- 测试网络账户没有资金

**解决方法：**
- 使用测试水龙头获取测试资金：https://testnet.binance.vision/

## 注意事项

⚠️ **重要提示：**

1. **安全第一**
   - 不要在公网环境中分享API Key和Secret
   - 建议使用IP白名单限制访问
   - 定期更换API Key

2. **测试优先**
   - 首次使用先用测试网络
   - 验证功能正常后再使用真实账户
   - 使用小额资金测试

3. **网络稳定**
   - 运行策略时确保网络稳定
   - 避免频繁切换网络

4. **日志记录**
   - 所有操作都会记录到日志文件
   - 日志位置：`logs/trading.log`
   - 遇到问题时查看日志获取详细信息
